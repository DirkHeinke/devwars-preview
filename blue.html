<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Blue Team</title>
    <style>
        @import url(http://fonts.googleapis.com/css?family=Roboto:400,400italic,300|Montserrat);

        * {
            margin: 0;
            padding: 0;
        }

        html {
            height: 100%;
        }

        body {
            height: 100%;
            overflow: hidden;
        }

        iframe {
            border: 0;
        }

        #reload {
            float: right;
            font-size: 1rem;
            padding-right: 20px;
        }

        .bar {
            position: absolute;
            width: 100%;
            height: 50px;
            line-height: 50px;
            padding-left: 10px;
            color: #fff;
            background-color: #232323;
            font-family: 'Montserrat', sans-serif;
            font-size: 2em;
            font-weight: 400;
        }

        .bar img {
            height: 40px;
            vertical-align: text-top;
        }

        .iframe {
            position: absolute;
            width: 100%;
            height: calc(100% - 50px);
            top: 50px;
        }
    </style>
</head>
<body>
<div class="bar">
    <div class="left">
        <img src="logo.png">
        <span>Team Blue - Preview</span>
    </div>
    <div class="center">
        <span id="player1"></span>
        <span id="player2"></span>
        <span id="player3"></span>
    </div>
    <div class="right">
        <label id="reload">
            <input type="checkbox" onclick="toggleReload()">
            Autoreload - 30 sec
        </label>
    </div>
</div>

<!--
<iframe src="http://blue.devwars.tv" class="iframe" id="iframe1">

</iframe>
-->

<script>
    var reload = false;

    getPlayerdata();

    function toggleReload() {
        reload = !reload;
    }

    setInterval(function () {
        getPlayerdata();

        if(reload) {
            reloadFrame();
        }
    }, 30000);

    function reloadFrame() {
        var iframe = document.getElementById('iframe1');
        iframe.src = iframe.src;
    }

    function getPlayerdata() {

        var xmlhttp = new XMLHttpRequest();
        var url = "http://devwars.tv/v1/game/currentgame";

        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                var data = JSON.parse(xmlhttp.responseText);
                handleResponse(data);
            }
        };
        xmlhttp.open("GET", url, true);
        xmlhttp.send();

        function handleResponse(data) {
            document.getElementById("player1").innerHTML = data.teams.blue.players[0].user.username;
            document.getElementById("player2").innerHTML = data.teams.blue.players[1].user.username;
            document.getElementById("player3").innerHTML = data.teams.blue.players[2].user.username;
        }
    }

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-61426517-3', 'auto');
    ga('send', 'pageview');

</script>
</body>
</html>